jQuery(document).ready(function (e) { e(".js-wsb-add-to-cart").on("click", function (t) { t.preventDefault(); var o = e(this), i = e("form.cart").serializeArray().reduce(function (e, t) { return e[t.name] = t.value, e }, {}); void 0 !== i["add-to-cart"] && null !== i["add-to-cart"] && delete i["add-to-cart"], i["wsb-buy-now"] = o.val(), i["wsb-nonce"] = buy_now_woo.nonce, i.action = "wsb_add_to_cart_ajax", e.ajax({ url: buy_now_woo.ajax_url, type: "POST", data: i, beforeSend: function () { o.addClass("wsb-loading") }, success: function (t) { o.removeClass("wsb-loading"); var i = t.data.element, a = t.data.template, n = t.data.redirect, c = t.data.checkout_url, r = t.data.method; "append" == r ? e(i).append(a) : "prepend" == r ? e(i).prepend(a) : e(i).html(a), n ? e(location).attr("href", c) : (function t() { if ("undefined" == typeof wc_checkout_params) return !1; e.blockUI.defaults.overlayCSS.cursor = "default"; var o = { updateTimer: !1, dirtyInput: !1, selectedPaymentMethod: !1, xhr: !1, $order_review: e("#order_review"), $checkout_form: e("form.checkout"), init: function () { e(document.body).bind("update_checkout", this.update_checkout), e(document.body).bind("init_checkout", this.init_checkout), this.$checkout_form.on("click", 'input[name="payment_method"]', this.payment_method_selected), e(document.body).hasClass("woocommerce-order-pay") && this.$order_review.on("click", 'input[name="payment_method"]', this.payment_method_selected), this.$checkout_form.attr("novalidate", "novalidate"), this.$checkout_form.on("submit", this.submit), this.$checkout_form.on("input validate change", ".input-text, select, input:checkbox", this.validate_field), this.$checkout_form.on("update", this.trigger_update_checkout), this.$checkout_form.on("change", 'select.shipping_method, input[name^="shipping_method"], #ship-to-different-address input, .update_totals_on_change select, .update_totals_on_change input[type="radio"], .update_totals_on_change input[type="checkbox"]', this.trigger_update_checkout), this.$checkout_form.on("change", ".address-field select", this.input_changed), this.$checkout_form.on("change", ".address-field input.input-text, .update_totals_on_change input.input-text", this.maybe_input_changed), this.$checkout_form.on("keydown", ".address-field input.input-text, .update_totals_on_change input.input-text", this.queue_update_checkout), this.$checkout_form.on("change", "#ship-to-different-address input", this.ship_to_different_address), this.$checkout_form.find("#ship-to-different-address input").change(), this.init_payment_methods(), "1" === wc_checkout_params.is_checkout && e(document.body).trigger("init_checkout"), "yes" === wc_checkout_params.option_guest_checkout && e("input#createaccount").change(this.toggle_create_account).change() }, init_payment_methods: function () { var t = e(".woocommerce-checkout").find('input[name="payment_method"]'); 1 === t.length && t.eq(0).hide(), o.selectedPaymentMethod && e("#" + o.selectedPaymentMethod).prop("checked", !0), 0 === t.filter(":checked").length && t.eq(0).prop("checked", !0), t.filter(":checked").eq(0).trigger("click") }, get_payment_method: function () { return o.$checkout_form.find('input[name="payment_method"]:checked').val() }, payment_method_selected: function () { if (e(".payment_methods input.input-radio").length > 1) { var t = e("div.payment_box." + e(this).attr("ID")); e(this).is(":checked") && !t.is(":visible") && (e("div.payment_box").filter(":visible").slideUp(250), e(this).is(":checked") && e("div.payment_box." + e(this).attr("ID")).slideDown(250)) } else e("div.payment_box").show(); e(this).data("order_button_text") ? e("#place_order").text(e(this).data("order_button_text")) : e("#place_order").text(e("#place_order").data("value")); var i = e('.woocommerce-checkout input[name="payment_method"]:checked').attr("id"); i !== o.selectedPaymentMethod && e(document.body).trigger("payment_method_selected"), o.selectedPaymentMethod = i }, toggle_create_account: function () { e("div.create-account").hide(), e(this).is(":checked") && (e("#account_password").val("").change(), e("div.create-account").slideDown()) }, init_checkout: function () { e("#billing_country, #shipping_country, .country_to_state").change(), e(document.body).trigger("update_checkout") }, maybe_input_changed: function (e) { o.dirtyInput && o.input_changed(e) }, input_changed: function (e) { o.dirtyInput = e.target, o.maybe_update_checkout() }, queue_update_checkout: function (e) { if (9 === (e.keyCode || e.which || 0)) return !0; o.dirtyInput = this, o.reset_update_checkout_timer(), o.updateTimer = setTimeout(o.maybe_update_checkout, "1000") }, trigger_update_checkout: function () { o.reset_update_checkout_timer(), o.dirtyInput = !1, e(document.body).trigger("update_checkout") }, maybe_update_checkout: function () { var t = !0; if (e(o.dirtyInput).length) { var i = e(o.dirtyInput).closest("div").find(".address-field.validate-required"); i.length && i.each(function () { "" === e(this).find("input.input-text").val() && (t = !1) }) } t && o.trigger_update_checkout() }, ship_to_different_address: function () { e("div.shipping_address").hide(), e(this).is(":checked") && e("div.shipping_address").slideDown() }, reset_update_checkout_timer: function () { clearTimeout(o.updateTimer) }, is_valid_json: function (t) { try { var o = e.parseJSON(t); return o && "object" == typeof o } catch (i) { return !1 } }, validate_field: function (t) { var o = e(this), i = o.closest(".form-row"), a = !0, n = i.is(".validate-required"), c = i.is(".validate-email"), r = t.type; "input" === r && i.removeClass("woocommerce-invalid woocommerce-invalid-required-field woocommerce-invalid-email woocommerce-validated"), ("validate" === r || "change" === r) && (n && ("checkbox" !== o.attr("type") || o.is(":checked") ? "" === o.val() && (i.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"), a = !1) : (i.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"), a = !1)), c && o.val() && (RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(o.val()) || (i.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-email"), a = !1)), a && i.removeClass("woocommerce-invalid woocommerce-invalid-required-field woocommerce-invalid-email").addClass("woocommerce-validated")) }, update_checkout: function (e, t) { o.reset_update_checkout_timer(), o.updateTimer = setTimeout(o.update_checkout_action, "5", t) }, update_checkout_action: function (t) { if (o.xhr && o.xhr.abort(), 0 !== e("form.checkout").length) { t = void 0 !== t ? t : { update_shipping_method: !0 }; var i = e("#billing_country").val(), a = e("#billing_state").val(), n = e("input#billing_postcode").val(), c = e("#billing_city").val(), r = e("input#billing_address_1").val(), d = e("input#billing_address_2").val(), s = i, u = a, l = n, p = c, h = r, m = d, f = e(o.$checkout_form).find(".address-field.validate-required:visible"), g = !0; f.length && f.each(function () { "" === e(this).find(":input").val() && (g = !1) }), e("#ship-to-different-address").find("input").is(":checked") && (s = e("#shipping_country").val(), u = e("#shipping_state").val(), l = e("input#shipping_postcode").val(), p = e("#shipping_city").val(), h = e("input#shipping_address_1").val(), m = e("input#shipping_address_2").val()); var v = { security: wc_checkout_params.update_order_review_nonce, payment_method: o.get_payment_method(), country: i, state: a, postcode: n, city: c, address: r, address_2: d, s_country: s, s_state: u, s_postcode: l, s_city: p, s_address: h, s_address_2: m, has_full_address: g, post_data: e("form.checkout").serialize() }; if (!1 !== t.update_shipping_method) { var y = {}; e('select.shipping_method, input[name^="shipping_method"][type="radio"]:checked, input[name^="shipping_method"][type="hidden"]').each(function () { y[e(this).data("index")] = e(this).val() }), v.shipping_method = y } e(".woocommerce-checkout-payment, .woocommerce-checkout-review-order-table").block({ message: null, overlayCSS: { background: "#fff", opacity: .6 } }), o.xhr = e.ajax({ type: "POST", url: wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%", "update_order_review"), data: v, success: function (t) { if (!0 === t.reload) { window.location.reload(); return } e(".woocommerce-NoticeGroup-updateOrderReview").remove(); var i = e("#terms").prop("checked"), a = {}; if (e(".payment_box input").each(function () { var t = e(this).attr("id"); t && (-1 !== e.inArray(e(this).attr("type"), ["checkbox", "radio"]) ? a[t] = e(this).prop("checked") : a[t] = e(this).val()) }), t && t.fragments && e.each(t.fragments, function (t, o) { e(t).replaceWith(o), e(t).unblock() }), i && e("#terms").prop("checked", !0), e.isEmptyObject(a) || e(".payment_box input").each(function () { var t = e(this).attr("id"); t && (-1 !== e.inArray(e(this).attr("type"), ["checkbox", "radio"]) ? e(this).prop("checked", a[t]).change() : 0 === e(this).val().length && e(this).val(a[t]).change()) }), "failure" === t.result) { var n = e("form.checkout"); e(".woocommerce-error, .woocommerce-message").remove(), t.messages ? n.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-updateOrderReview">' + t.messages + "</div>") : n.prepend(t), n.find(".input-text, select, input:checkbox").trigger("validate").blur(), o.scroll_to_notices() } o.init_payment_methods(), e(document.body).trigger("updated_checkout", [t]) } }) } }, submit: function () { o.reset_update_checkout_timer(); var t = e(this); return !t.is(".processing") && (!1 !== t.triggerHandler("checkout_place_order") && !1 !== t.triggerHandler("checkout_place_order_" + o.get_payment_method()) && (t.addClass("processing"), 1 !== t.data()["blockUI.isBlocked"] && t.block({ message: null, overlayCSS: { background: "#fff", opacity: .6 } }), e.ajaxSetup({ dataFilter: function (e, t) { if ("json" !== t) return e; if (o.is_valid_json(e)); else { var i = e.match(/{"result.*}/); null === i ? console.log("Unable to fix malformed JSON") : o.is_valid_json(i[0]) ? (console.log("Fixed malformed JSON. Original:"), console.log(e), e = i[0]) : console.log("Unable to fix malformed JSON") } return e } }), e.ajax({ type: "POST", url: wc_checkout_params.checkout_url, data: t.serialize(), dataType: "json", success: function (t) { try { if ("success" === t.result) -1 === t.redirect.indexOf("https://") || -1 === t.redirect.indexOf("http://") ? window.location = t.redirect : window.location = decodeURI(t.redirect); else if ("failure" === t.result) throw "Result failure"; else throw "Invalid response" } catch (i) { if (!0 === t.reload) { window.location.reload(); return } !0 === t.refresh && e(document.body).trigger("update_checkout"), t.messages ? o.submit_error(t.messages) : o.submit_error('<div class="woocommerce-error">' + wc_checkout_params.i18n_checkout_error + "</div>") } }, error: function (e, t, i) { o.submit_error('<div class="woocommerce-error">' + i + "</div>") } })), !1) }, submit_error: function (t) { e(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(), o.$checkout_form.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">' + t + "</div>"), o.$checkout_form.removeClass("processing").unblock(), o.$checkout_form.find(".input-text, select, input:checkbox").trigger("validate").blur(), o.scroll_to_notices(), e(document.body).trigger("checkout_error") }, scroll_to_notices: function () { var t = e(".woocommerce-NoticeGroup-updateOrderReview, .woocommerce-NoticeGroup-checkout"), o = "scrollBehavior" in document.documentElement.style; t.length || (t = e(".form.checkout")), t.length && (o ? t[0].scrollIntoView({ behavior: "smooth" }) : e("html, body").animate({ scrollTop: t.offset().top - 100 }, 1e3)) } }; o.init(), ({ init: function () { e(document.body).on("click", ".woocommerce-remove-coupon", this.remove_coupon), e("form.checkout_coupon").hide().submit(this.submit) }, show_coupon_form: function () { return e(".checkout_coupon").slideToggle(400, function () { e(".checkout_coupon").find(":input:eq(0)").focus() }), !1 }, submit: function () { var t = e(this); if (t.is(".processing")) return !1; t.addClass("processing").block({ message: null, overlayCSS: { background: "#fff", opacity: .6 } }); var o = { security: wc_checkout_params.apply_coupon_nonce, coupon_code: t.find('input[name="coupon_code"]').val() }; return e.ajax({ type: "POST", url: wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%", "apply_coupon"), data: o, success: function (o) { e(".woocommerce-error, .woocommerce-message").remove(), t.removeClass("processing").unblock(), o && (t.before(o), t.slideUp(), e(document.body).trigger("update_checkout", { update_shipping_method: !1 })) }, dataType: "html" }), !1 }, remove_coupon: function (t) { t.preventDefault(); var o = e(this).parents(".woocommerce-checkout-review-order"), i = e(this).data("coupon"); o.addClass("processing").block({ message: null, overlayCSS: { background: "#fff", opacity: .6 } }); var a = { security: wc_checkout_params.remove_coupon_nonce, coupon: i }; e.ajax({ type: "POST", url: wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%", "remove_coupon"), data: a, success: function (t) { e(".woocommerce-error, .woocommerce-message").remove(), o.removeClass("processing").unblock(), t && (e("form.woocommerce-checkout").before(t), e(document.body).trigger("update_checkout", { update_shipping_method: !1 }), e("form.checkout_coupon").find('input[name="coupon_code"]').val("")) }, error: function (e) { wc_checkout_params.debug_mode && console.log(e.responseText) }, dataType: "html" }) } }).init(), ({ init: function () { e(document.body).on("click", "a.showlogin", this.show_login_form) }, show_login_form: function () { return e("form.login, form.woocommerce-form--login").slideToggle(), !1 } }).init(), ({ init: function () { e(document.body).on("click", "a.woocommerce-terms-and-conditions-link", this.toggle_terms) }, toggle_terms: function () { if (e(".woocommerce-terms-and-conditions").length) return e(".woocommerce-terms-and-conditions").slideToggle(), !1 } }).init() }(), function t() { if ("undefined" == typeof wc_country_select_params) return !1; if (e().selectWoo) { var o = function () { e("select.country_select:visible, select.state_select:visible").each(function () { var t = e.extend({ placeholderOption: "first", width: "100%" }, { language: { errorLoading: function () { return wc_country_select_params.i18n_searching }, inputTooLong: function (e) { var t = e.input.length - e.maximum; return 1 === t ? wc_country_select_params.i18n_input_too_long_1 : wc_country_select_params.i18n_input_too_long_n.replace("%qty%", t) }, inputTooShort: function (e) { var t = e.minimum - e.input.length; return 1 === t ? wc_country_select_params.i18n_input_too_short_1 : wc_country_select_params.i18n_input_too_short_n.replace("%qty%", t) }, loadingMore: function () { return wc_country_select_params.i18n_load_more }, maximumSelected: function (e) { return 1 === e.maximum ? wc_country_select_params.i18n_selection_too_long_1 : wc_country_select_params.i18n_selection_too_long_n.replace("%qty%", e.maximum) }, noResults: function () { return wc_country_select_params.i18n_no_matches }, searching: function () { return wc_country_select_params.i18n_searching } } }); e(this).selectWoo(t), e(this).on("select2:select", function () { e(this).focus() }) }) }; o(), e(document.body).bind("country_to_state_changed", function () { o() }) } var i = wc_country_select_params.countries.replace(/&quot;/g, '"'), a = e.parseJSON(i); e(document.body).on("change", "select.country_to_state, input.country_to_state", function () { var t = e(this).closest(".woocommerce-billing-fields, .woocommerce-shipping-fields, .woocommerce-shipping-calculator"); t.length || (t = e(this).closest(".form-row").parent()); var o = e(this).val(), i = t.find("#billing_state, #shipping_state, #calc_shipping_state"), n = i.closest("p.form-row"), c = i.attr("name"), r = i.attr("id"), d = i.val(), s = i.attr("placeholder") || i.attr("data-placeholder") || ""; if (a[o]) { if (e.isEmptyObject(a[o])) i.closest("p.form-row").hide().find(".select2-container").remove(), i.replaceWith('<input type="hidden" class="hidden" name="' + c + '" id="' + r + '" value="" placeholder="' + s + '" />'), e(document.body).trigger("country_to_state_changed", [o, t]); else { var u = "", l = a[o]; for (var p in l) l.hasOwnProperty(p) && (u = u + '<option value="' + p + '">' + l[p] + "</option>"); i.closest("p.form-row").show(), i.is("input") && (i.replaceWith('<select name="' + c + '" id="' + r + '" class="state_select" data-placeholder="' + s + '"></select>'), i = t.find("#billing_state, #shipping_state, #calc_shipping_state")), i.html('<option value="">' + wc_country_select_params.i18n_select_state_text + "</option>" + u), i.val(d).change(), e(document.body).trigger("country_to_state_changed", [o, t]) } } else i.is("select") ? (n.show().find(".select2-container").remove(), i.replaceWith('<input type="text" class="input-text" name="' + c + '" id="' + r + '" placeholder="' + s + '" />'), e(document.body).trigger("country_to_state_changed", [o, t])) : i.is('input[type="hidden"]') && (n.show().find(".select2-container").remove(), i.replaceWith('<input type="text" class="input-text" name="' + c + '" id="' + r + '" placeholder="' + s + '" />'), e(document.body).trigger("country_to_state_changed", [o, t])); e(document.body).trigger("country_to_state_changing", [o, t]) }) }(), function t() { if ("undefined" == typeof wc_address_i18n_params) return !1; var o = wc_address_i18n_params.locale.replace(/&quot;/g, '"'), i = e.parseJSON(o); function a(e, t) { t ? (e.find("label .optional").remove(), e.addClass("validate-required"), 0 === e.find("label .required").length && e.find("label").append('&nbsp;<abbr class="required" title="' + wc_address_i18n_params.i18n_required_text + '">*</abbr>')) : (e.find("label .required").remove(), e.removeClass("validate-required"), 0 === e.find("label .optional").length && e.find("label").append('&nbsp;<span class="optional">(' + wc_address_i18n_params.i18n_optional_text + ")</span>")) } e(document.body).bind("country_to_state_changing", function (t, o, n) { var c, r = n; c = void 0 !== i[o] ? i[o] : i.default; var d = r.find("#billing_postcode_field, #shipping_postcode_field"), s = r.find("#billing_city_field, #shipping_city_field"), u = r.find("#billing_state_field, #shipping_state_field"); d.attr("data-o_class") || (d.attr("data-o_class", d.attr("class")), s.attr("data-o_class", s.attr("class")), u.attr("data-o_class", u.attr("class"))); var l = e.parseJSON(wc_address_i18n_params.locale_fields); e.each(l, function (t, o) { var n = r.find(o), d = e.extend(!0, {}, i.default[t], c[t]); void 0 !== d.label && n.find("label").html(d.label), void 0 !== d.placeholder && (n.find("input").attr("placeholder", d.placeholder), n.find(".select2-selection__placeholder").text(d.placeholder)), void 0 !== d.placeholder || void 0 === d.label || n.find("label").length || (n.find("input").attr("placeholder", d.label), n.find(".select2-selection__placeholder").text(d.label)), void 0 !== d.required ? a(n, d.required) : a(n, !1), void 0 !== d.priority && n.data("priority", d.priority), "state" !== t && (void 0 !== d.hidden && !0 === d.hidden ? n.hide().find("input").val("") : n.show()) }), e(".woocommerce-billing-fields__field-wrapper, .woocommerce-shipping-fields__field-wrapper, .woocommerce-address-fields__field-wrapper, .woocommerce-additional-fields__field-wrapper .woocommerce-account-fields").each(function (t, o) { var i = e(o).find(".form-row"), a = i.first().parent(), n = 0; i.each(function () { e(this).data("priority") || e(this).data("priority", n + 1), n = e(this).data("priority") }), i.sort(function (t, o) { var i = e(t).data("priority"), a = e(o).data("priority"); return i > a ? 1 : i < a ? -1 : 0 }), i.detach().appendTo(a) }) }) }(), e(document.body).trigger("wsb_checkout_template_added"), e(".wsb-modal").addClass("is-visible")) } }) }), e(".wsb-modal-toggle").on("click", function (t) { t.preventDefault(), e(".wsb-modal").removeClass("is-visible") }), e(".variations_form").on("hide_variation", function (t) { e(this).find(".js-wsb-add-to-cart").addClass("disabled").attr("disabled", "disabled") }), e(".variations_form").on("show_variation", function (t, o, i) { t.preventDefault(), i && e(this).find(".js-wsb-add-to-cart").removeClass("disabled").removeAttr("disabled") }) });